<section class="materi-detail fade-in" style="text-align: left;">
  <h2>ğŸ“ Evaluasi Geometri</h2>
  <p>Soal Evaluasi Geometri</p>

  <style>
    .eval-feedback { margin-top:8px; padding:8px; border-radius:4px; font-weight:600; }
    li.eval-correct { background: rgba(40,167,69,0.04); }
    li.eval-incorrect { background: rgba(220,53,69,0.04); }
    li.eval-correct .eval-feedback { background:#c8e6c9; color:#1b5e20; border-left:4px solid #28a745; }
    li.eval-incorrect .eval-feedback { background:#ffcdd2; color:#b71c1c; border-left:4px solid #dc3545; }
  </style>

  <form id="evalG">
    <ol class="eval-list">
      <li>
        <p>Perhatikan gambar bangun ruang gabungan di bawah ini. Bangun tersebut terdiri dari sebuah balok di bagian bawah dan sebuah kubus di bagian atas.

        Diketahui:
        <br>Dimensi Balok (Bawah): Panjang p = 15 cm, Lebar l = 8 cm, dan Tinggi t = 10 cm.
        <br>Kubus (Atas): Memiliki panjang sisi s yang sama dengan lebar balok, yaitu 8 cm.
        <br>Hitunglah volume total bangun ruang gabungan tersebut!</p>
        <div class="options">
          <label><input type="radio" name="q1" value="A"> A. 2200 cmÂ³</label><br>
          <label><input type="radio" name="q1" value="B"> B. 1543 cmÂ³</label><br>
          <label><input type="radio" name="q1" value="C"> C. 1712 cmÂ³</label><br>
          <label><input type="radio" name="q1" value="D"> D. 1200 cmÂ³</label>
        </div>
      </li>

      <li>
        <p>Sebuah Kubus dengan panjang rusuk 6 cm diletakkan tepat di atas sebuah Balok dengan ukuran panjang 10 cm, lebar 8 cm, dan tinggi 4 cm. Berapakah volume total bangun gabungan tersebut?</p>
        <div class="options">
          <label><input type="radio" name="q2" value="A"> A. 720 cmÂ³</label><br>
          <label><input type="radio" name="q2" value="B"> B. 420 cmÂ³</label><br>
          <label><input type="radio" name="q2" value="C"> C. 496 cmÂ³</label><br>
          <label><input type="radio" name="q2" value="D"> D. 536 cmÂ³</label>
        </div>
      </li>

      <li>
        <p>Tindakan memisah gabungan bangun ruang tertentu seperti kubus dan balok untuk mengetahui banyak bangun ruang penyusunnya disebut...</p>
        <div class="options">
          <label><input type="radio" name="q3" value="A"> A. Menyatukan</label><br>
          <label><input type="radio" name="q3" value="B"> B. Mengonstruksi</label><br>
          <label><input type="radio" name="q3" value="C"> C. Meratakan</label><br>
          <label><input type="radio" name="q3" value="D"> D. Mengurai</label>
        </div>
      </li>

      <li>
        <p>Tindakan menyusun bangun ruang sederhana (seperti kubus atau balok kecil) menjadi bangun ruang yang lebih kompleks atau besar disebut...</p>
        <div class="options">
          <label><input type="radio" name="q4" value="A"> A. Mengurai</label><br>
          <label><input type="radio" name="q4" value="B"> B. Memisahkan</label><br>
          <label><input type="radio" name="q4" value="C"> C. Mengonstruksi</label><br>
          <label><input type="radio" name="q4" value="D"> D. Menghitung</label>
        </div>
      </li>

      <li>
        <p>Sebuah kardus berbentuk kubus dengan panjang rusuk 10 cm. Jika di dalamnya akan diisi kubus-kubus kecil dengan panjang rusuk 2 cm, berapa banyak kubus kecil yang dapat dimasukkan ke dalam kardus besar?</p>
        <div class="options">
          <label><input type="radio" name="q5" value="A"> A. 5 buah</label><br>
          <label><input type="radio" name="q5" value="B"> B. 25 buah</label><br>
          <label><input type="radio" name="q5" value="C"> C. 100 buah</label><br>
          <label><input type="radio" name="q5" value="D"> D. 125 buah</label>
        </div>
        <p class="hint">Petunjuk: Hitung volume kardus besar (10Ã—10Ã—10 = 1000 cmÂ³) dan volume kubus kecil (2Ã—2Ã—2 = 8 cmÂ³). Banyak kubus = Volume Besar / Volume Kecil.</p>
      </li>

      <li>
        <p>Sebuah balok memiliki panjang 15 cm, lebar 10 cm, dan tinggi 5 cm. Bangun tersebut disusun dari tumpukan kubus satuan. Jika setiap kubus satuan memiliki rusuk 1 cm, banyak kubus satuan yang menyusun balok tersebut adalah...</p>
        <div class="options">
          <label><input type="radio" name="q6" value="A"> A. 30 buah</label><br>
          <label><input type="radio" name="q6" value="B"> B. 75 buah</label><br>
          <label><input type="radio" name="q6" value="C"> C. 750 buah</label><br>
          <label><input type="radio" name="q6" value="D"> D. 1500 buah</label>
        </div>
        <p class="hint">Petunjuk: Banyak kubus satuan = Volume Balok (15 Ã— 10 Ã— 5).</p>
      </li>

      <li>
        <p>Perhatikan gambar berikut.</p>
        <div class="materi-image" style="margin: 12px 0; text-align: center;">
          <img src="assets/img/Soal Evaluasi Geometri No 7.jpg" alt="Soal Evaluasi Geometri No 7" style="max-width:100%;height:auto;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.08);">
        </div>
        <div class="options">
          <label><input type="radio" name="q7" value="A"> A. Terbuat dari 2 kubus</label><br>
          <label><input type="radio" name="q7" value="B"> B. Terbuat dari 3 kubus</label><br>
          <label><input type="radio" name="q7" value="C"> C. Terbuat dari 2 balok</label><br>
          <label><input type="radio" name="q7" value="D"> D. Terbuat dari 3 balok</label>
        </div>
      </li>

      <li>
        <p>Perhatikan gambar berikut.</p>
        <div class="materi-image" style="margin: 12px 0; text-align: center;">
          <img src="assets/img/Soal Evaluasi Geometri No 8.jpg" alt="Soal Evaluasi Geometri No 8" style="max-width:100%;height:auto;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.08);">
        </div>
        <div class="options">
          <label><input type="radio" name="q8" value="A"> A. 13</label><br>
          <label><input type="radio" name="q8" value="B"> B. 14</label><br>
          <label><input type="radio" name="q8" value="C"> C. 15</label><br>
          <label><input type="radio" name="q8" value="D"> D. 16</label>
        </div>
      </li>

      <li>
        <p>Ruang kelas berbentuk balok memiliki panjang 10 meter, lebar 6 meter, dan tinggi 3 meter. Berapakah volume ruang kelas tersebut?</p>
        <div class="options">
          <label><input type="radio" name="q9" value="A"> A. 19 mÂ³</label><br>
          <label><input type="radio" name="q9" value="B"> B. 60 mÂ³</label><br>
          <label><input type="radio" name="q9" value="C"> C. 120 mÂ³</label><br>
          <label><input type="radio" name="q9" value="D"> D. 180 mÂ³</label>
        </div>
      </li>

      <li>
        <p>Perhatikan gambar berikut.</p>
        <div class="materi-image" style="margin: 12px 0; text-align: center;">
          <img src="assets/img/Soal Evaluasi Geometri No 10.jpg" alt="Soal Evaluasi Geometri No 10" style="max-width:100%;height:auto;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.08);">
        </div>
        <div class="options">
          <label><input type="radio" name="q10" value="A"> A</label><br>
          <label><input type="radio" name="q10" value="B"> B</label><br>
          <label><input type="radio" name="q10" value="C"> C</label><br>
          <label><input type="radio" name="q10" value="D"> D</label>
        </div>
      </li>
    </ol>

    <div class="form-actions" style="margin-top:16px;">
      <button class="menu-btn" type="submit">Kumpulkan</button>
      <button class="backBtn" type="button" onclick="history.back()">Batal</button>
    </div>
  </form>

  <div id="evalResult" style="margin-top:14px; font-weight:600;"></div>

</section>

<script>
  (function(){
    const form = document.getElementById('evalG');

    // kunci jawaban (kosong berarti soal gambar / belum dinilai)
    const answerKey = {
      q1: 'C',
      q2: 'D',
      q3: 'D',
      q4: 'C',
      q5: 'D',
      q6: 'C',
      q7: null,
      q8: null,
      q9: 'D',
      q10: null
    };

    form.addEventListener('submit', function(e){
      e.preventDefault();
      const formData = new FormData(form);
      let correct = 0;
      let scorable = 0;
      for(const q in answerKey){
        const key = answerKey[q];
        const val = (formData.get(q) || '').toString().trim().toUpperCase();
        if(key !== null){
          scorable++;
          if(val === key) correct++;
        }
      }

      const score = scorable > 0 ? Math.round((correct / scorable) * 100) : 0;
      // simpan skor dengan key 'geometri' (tersesuaikan dengan sistem yang ada)
      try{ window.simpanSkor && window.simpanSkor('geometri', score); }catch(e){/* ignore */}

      const resultDiv = document.getElementById('evalResult');
      resultDiv.innerHTML = `Hasil: ${correct} dari ${scorable} soal terpilih benar. Skor = ${score}`;

      // per-soal feedback: tampilkan apakah benar/salah dan jawaban yang benar jika salah
      for(const q in answerKey){
        const key = answerKey[q];
        if(key === null) continue; // skip unscored
        const val = (formData.get(q) || '').toString().trim().toUpperCase();

        // find the list item containing this question
        const inputEl = form.querySelector(`[name="${q}"]`);
        if(!inputEl) continue;
        const li = inputEl.closest('li');
        if(!li) continue;

        // remove old feedback
        const old = li.querySelector('.eval-feedback');
        if(old) old.remove();
        li.classList.remove('eval-correct','eval-incorrect');

        const fb = document.createElement('div');
        fb.className = 'eval-feedback';

        if(val === key){
          li.classList.add('eval-correct');
          fb.textContent = 'âœ… Jawaban Benar';
        } else {
          li.classList.add('eval-incorrect');
          // get readable correct option text (label content)
          const correctInput = li.querySelector(`input[name="${q}"][value="${key}"]`);
          let correctText = key;
          if(correctInput){
            const label = correctInput.closest('label');
            if(label) correctText = label.textContent.trim();
          }
          fb.innerHTML = `âŒ Jawaban Salah. Jawaban benar: <strong>${correctText}</strong>`;
        }

        // insert feedback after the options block
        const options = li.querySelector('.options');
        if(options) options.parentNode.insertBefore(fb, options.nextSibling);
        else li.appendChild(fb);
      }

      // scroll to result
      resultDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
    });
  })();
</script>
