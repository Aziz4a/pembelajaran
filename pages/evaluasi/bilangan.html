<section class="materi-detail fade-in" style="text-align: left;">
  <h2>üìù Evaluasi Bilangan</h2>
  <p>Kerjakan 10 soal evaluasi berikut (masukkan jawaban dengan angka saja, tanpa pemisah ribuan):</p>
  
  <style>
    .eval-feedback { margin-top:8px; padding:8px; border-radius:4px; font-weight:600; }
    .eval-question.eval-correct { background: rgba(40,167,69,0.04); }
    .eval-question.eval-incorrect { background: rgba(220,53,69,0.04); }
    .eval-question.eval-correct .eval-feedback { background:#c8e6c9; color:#1b5e20; border-left:4px solid #28a745; }
    .eval-question.eval-incorrect .eval-feedback { background:#ffcdd2; color:#b71c1c; border-left:4px solid #dc3545; }
  </style>

  <form id="evalB" style="margin-top: 20px;">
    <!-- Soal 1-10 dengan gambar -->
    <div class="eval-question" style="margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
      <h4>Soal 1</h4>
      <div class="eval-image" style="margin: 15px 0;">
        <img src="assets/img/Soal Evaluasi Bilangan No 1.jpg" alt="Soal Evaluasi Bilangan No 1" style="max-width:100%;height:auto">
      </div>
      <div class="answer-box">
        <input required type="text" class="answer-input" name="q1" inputmode="numeric" placeholder="Masukkan jawaban" data-answer="">
      </div>
    </div>

    <div class="eval-question" style="margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
      <h4>Soal 2</h4>
      <div class="eval-image" style="margin: 15px 0;">
        <img src="assets/img/Soal Evaluasi Bilangan No 2.jpg" alt="Soal Evaluasi Bilangan No 2" style="max-width:100%;height:auto">
      </div>
      <div class="answer-box">
        <input required type="text" class="answer-input" name="q2" inputmode="numeric" placeholder="Masukkan jawaban" data-answer="">
      </div>
    </div>

    <div class="eval-question" style="margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
      <h4>Soal 3</h4>
      <div class="eval-image" style="margin: 15px 0;">
        <img src="assets/img/Soal Evaluasi Bilangan No 3.jpg" alt="Soal Evaluasi Bilangan No 3" style="max-width:100%;height:auto">
      </div>
      <div class="answer-box">
        <input required type="text" class="answer-input" name="q3" inputmode="numeric" placeholder="Masukkan jawaban" data-answer="">
      </div>
    </div>

    <div class="eval-question" style="margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
      <h4>Soal 4</h4>
      <div class="eval-image" style="margin: 15px 0;">
        <img src="assets/img/Soal Evaluasi Bilangan No 4.jpg" alt="Soal Evaluasi Bilangan No 4" style="max-width:100%;height:auto">
      </div>
      <div class="answer-box">
        <input required type="text" class="answer-input" name="q4" inputmode="numeric" placeholder="Masukkan jawaban" data-answer="">
      </div>
    </div>

    <div class="eval-question" style="margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
      <h4>Soal 5</h4>
      <div class="eval-image" style="margin: 15px 0;">
        <img src="assets/img/Soal Evaluasi Bilangan No 5.jpg" alt="Soal Evaluasi Bilangan No 5" style="max-width:100%;height:auto">
      </div>
      <div class="answer-box">
        <input required type="text" class="answer-input" name="q5" inputmode="numeric" placeholder="Masukkan jawaban" data-answer="">
      </div>
    </div>

    <div class="eval-question" style="margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
      <h4>Soal 6</h4>
      <div class="eval-image" style="margin: 15px 0;">
        <img src="assets/img/Soal Evaluasi Bilangan No 6.jpg" alt="Soal Evaluasi Bilangan No 6" style="max-width:100%;height:auto">
      </div>
      <div class="answer-box">
        <input required type="text" class="answer-input" name="q6" inputmode="numeric" placeholder="Masukkan jawaban" data-answer="">
      </div>
    </div>

    <div class="eval-question" style="margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
      <h4>Soal 7</h4>
      <div class="eval-image" style="margin: 15px 0;">
        <img src="assets/img/Soal Evaluasi Bilangan No 7.jpg" alt="Soal Evaluasi Bilangan No 7" style="max-width:100%;height:auto">
      </div>
      <div class="answer-box">
        <input required type="text" class="answer-input" name="q7" inputmode="numeric" placeholder="Masukkan jawaban" data-answer="">
      </div>
    </div>

    <div class="eval-question" style="margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
      <h4>Soal 8</h4>
      <div class="eval-image" style="margin: 15px 0;">
        <img src="assets/img/Soal Evaluasi Bilangan No 8.jpg" alt="Soal Evaluasi Bilangan No 8" style="max-width:100%;height:auto">
      </div>
      <div class="answer-box">
        <input required type="text" class="answer-input" name="q8" inputmode="numeric" placeholder="Masukkan jawaban" data-answer="">
      </div>
    </div>

    <div class="eval-question" style="margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
      <h4>Soal 9</h4>
      <div class="eval-image" style="margin: 15px 0;">
        <img src="assets/img/Soal Evaluasi Bilangan No 9.jpg" alt="Soal Evaluasi Bilangan No 9" style="max-width:100%;height:auto">
      </div>
      <div class="answer-box">
        <input required type="text" class="answer-input" name="q9" inputmode="numeric" placeholder="Masukkan jawaban" data-answer="">
      </div>
    </div>

    <div class="eval-question" style="margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
      <h4>Soal 10</h4>
      <div class="eval-image" style="margin: 15px 0;">
        <img src="assets/img/Soal Evaluasi Bilangan No 10.jpg" alt="Soal Evaluasi Bilangan No 10" style="max-width:100%;height:auto">
      </div>
      <div class="answer-box">
        <input required type="text" class="answer-input" name="q10" inputmode="numeric" placeholder="Masukkan jawaban" data-answer="">
      </div>
    </div>

    <button class="backBtn" type="submit" style="margin-top: 20px;">Kumpulkan</button>
  </form>
  <p id="hasilB" style="margin-top: 20px; font-weight: bold; font-size: 1.1rem;"></p>
</section>

<script>
  (function(){
    const fB = document.getElementById('evalB');

    // Answer key for 10 questions - filled from provided answers
    const answerKey = {
      q1: '72670',   // 2795 √ó 26 = 72670
      q2: '13800',  // 345 √ó 40 = 13800
      q3: '90000',  // 1250 √ó 72 = 90000
      q4: '64000',  // 1600 √ó 40 = 64000
      q5: '110000', // 55000 √ó 2 = 110000
      q6: '12000',    // 72000 √∑ 6 = 12000
      q7: '9000',   // 72000 √∑ 8 = 9000
      q8: '4700',   // 56400 √∑ 12 = 4700
      q9: '3400',   // 85000 √∑ 25 = 3400
      q10: '6090'   // 91350 √∑ 15 = 6090
    };

    function clearOldFeedback(){
      document.querySelectorAll('.eval-feedback').forEach(n=>n.remove());
      document.querySelectorAll('.eval-question').forEach(q=>{ q.classList.remove('eval-correct','eval-incorrect'); });
    }

    fB.addEventListener('submit', (e) => {
      e.preventDefault();
      clearOldFeedback();

      let score = 0;
      let answered = 0;

      // Check each answer
      for (let i = 1; i <= 10; i++) {
        const qName = 'q' + i;
        const input = fB[qName];
        if(!input) continue;
        const userAnswer = input.value.trim();
        const correctAnswer = (answerKey[qName] || '').toString().trim();

        // find container for this question
        const qDiv = input.closest('.eval-question');
        if(!qDiv) continue;

        if (userAnswer !== '' && correctAnswer !== '') {
          answered++;
          if (userAnswer === correctAnswer) {
            score += 10; // Each question worth 10 points
            qDiv.classList.add('eval-correct');
            const fb = document.createElement('div'); fb.className='eval-feedback'; fb.textContent = '‚úÖ Jawaban Benar';
            qDiv.querySelector('.answer-box').after(fb);
          } else {
            qDiv.classList.add('eval-incorrect');
            const fb = document.createElement('div'); fb.className='eval-feedback';
            fb.innerHTML = `‚ùå Jawaban Salah. Jawaban benar: <strong>${correctAnswer}</strong>`;
            qDiv.querySelector('.answer-box').after(fb);
          }
        }
      }

      // Calculate percentage
      let percentage = answered > 0 ? Math.round((score / 100) * 100) : 0;
      try{ window.simpanSkor && window.simpanSkor('bilangan', percentage); }catch(e){/*ignore*/}
      document.getElementById('hasilB').textContent = `Skor kamu: ${score}/100 (${percentage}%)`;

      // scroll to result
      document.getElementById('hasilB').scrollIntoView({ behavior: 'smooth', block: 'center' });
    });
  })();
</script>
